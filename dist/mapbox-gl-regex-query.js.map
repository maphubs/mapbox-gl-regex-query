{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/@mapbox/whoots-js/index.umd.js","node_modules/ieee754/index.js","node_modules/mapbox-gl/src/geo/coordinate.js","node_modules/mapbox-gl/src/source/tile_coord.js","node_modules/mapbox-gl/src/util/vectortile_to_geojson.js","node_modules/pbf/buffer.js","node_modules/pbf/index.js","node_modules/point-geometry/index.js","node_modules/vector-tile/index.js","node_modules/vector-tile/lib/vectortile.js","node_modules/vector-tile/lib/vectortilefeature.js","node_modules/vector-tile/lib/vectortilelayer.js","src/feature_filter.js","src/index.js"],"names":["global","factory","exports","module","define","amd","WhooTS","this","getURL","baseUrl","layer","x","y","z","options","getTileBBox","format","service","version","request","srs","width","height","join","Math","pow","min","getMercCoords","max","resolution","PI","Object","defineProperty","value","read","buffer","offset","isLE","mLen","nBytes","e","m","eLen","eMax","eBias","nBits","i","d","s","NaN","Infinity","write","c","rt","abs","isNaN","floor","log","LN2","Coordinate","column","row","zoom","prototype","clone","zoomTo","_zoomTo","sub","_sub","scale","edge","a","b","const","t","x0","y0","x1","y1","dx","dy","scanSpans","e0","e1","ymin","ymax","scanLine","ceil","let","m0","m1","d0","d1","scanTriangle","ab","bc","ca","getQuadkey","mask","quadkey","require","TileCoord","w","dim","id","posMatrix","toString","toCoordinate","sourceMaxZoom","undefined","tileScale","url","urls","scheme","bbox","length","replace","parent","wrapped","children","cover","bounds","actualZ","renderWorldCopies","wx","coord","tiles","keys","map","fromID","xy","Feature","vectorTileFeature","type","_vectorTileFeature","_z","_x","_y","properties","prototypeAccessors","geometry","get","_geometry","toGeoJSON","set","g","toJSON","this$1","json","Buffer","arr","buf","Uint8Array","readUInt32LE","BufferMethods","writeUInt32LE","readInt32LE","writeInt32LE","readFloatLE","writeFloatLE","readDoubleLE","writeDoubleLE","slice","copy","_isBuffer","encodeString","str","lead","bytes","charCodeAt","push","ieee754","lastStr","lastStrEncoded","pos","val","encoding","start","end","tmp","ch","decodeURIComponent","String","fromCharCode","subarray","byteLength","isBuffer","Pbf","readVarintRemainder","pbf","Error","writeBigVarint","realloc","maxPos","reallocForRawMessage","startPos","len","extraLen","writePackedVarint","writeVarint","writePackedSVarint","writeSVarint","writePackedFloat","writeFloat","writePackedDouble","writeDouble","writePackedBoolean","writeBoolean","writePackedFixed32","writeFixed32","writePackedSFixed32","writeSFixed32","writePackedFixed64","writeFixed64","writePackedSFixed64","writeSFixed64","Varint","Fixed64","Bytes","Fixed32","SHIFT_LEFT_32","SHIFT_RIGHT_32","POW_2_63","destroy","readFields","readField","result","readVarint","tag","skip","readMessage","readFixed32","readSFixed32","readFixed64","readSFixed64","readFloat","readDouble","readVarint64","readSVarint","num","readBoolean","Boolean","readString","readBytes","readPackedVarint","readPackedSVarint","readPackedBoolean","readPackedFloat","readPackedDouble","readPackedFixed32","readPackedSFixed32","readPackedFixed64","readPackedSFixed64","writeTag","finish","writeString","writeBytes","writeRawMessage","fn","obj","writeMessage","writeBytesField","writeFixed32Field","writeSFixed32Field","writeFixed64Field","writeSFixed64Field","writeVarintField","writeSVarintField","writeStringField","writeFloatField","writeDoubleField","writeBooleanField","Point","add","p","_add","mult","k","_mult","div","_div","rotate","_rotate","matMult","_matMult","unit","_unit","perp","_perp","round","_round","mag","sqrt","equals","dist","distSqr","angle","atan2","angleTo","angleWith","angleWithSep","cos","sin","convert","Array","isArray","VectorTile","VectorTileFeature","VectorTileLayer","layers","readTile","name","extent","values","_pbf","_keys","_values","readFeature","feature","readTag","key","classifyRings","rings","polygon","ccw","polygons","area","signedArea","ring","p1","p2","sum","j","types","loadGeometry","line","cmd","lines","cmdLen","x2","y2","project","size","atan","exp","coords","points","coordinates","_features","readLayer","readValueMessage","createFilter","filter","Function","compile","op","compileComparisonOp","compileRegexOp","compileLogicalOp","compileNegation","compileInOp","compileHasOp","compilePropertyReference","property","JSON","stringify","checkType","left","right","indexOf","expressions","sort","compare","expression","vt","Protobuf","GeoJSONFeature","featureFilter","querySourceFeatures","sourceID","params","sourceCache","style","sourceCaches","getRenderableIds","getTileByID","dataTiles","tile","dataID","queryTile","rawTileData","vtLayers","_geojsonTileLayer","sourceLayer","geojsonFeature"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.WhooTS = global.WhooTS || {})));\n}(this, (function (exports) {\n\n/**\n * getURL\n *\n * @param    {String}  baseUrl  Base url of the WMS server\n * @param    {String}  layer    Layer name\n * @param    {Number}  x        Tile coordinate x\n * @param    {Number}  y        Tile coordinate y\n * @param    {Number}  z        Tile zoom\n * @param    {Object}  [options]\n * @param    {String}  [options.format='image/png']\n * @param    {String}  [options.service='WMS']\n * @param    {String}  [options.version='1.1.1']\n * @param    {String}  [options.request='GetMap']\n * @param    {String}  [options.srs='EPSG:3857']\n * @param    {Number}  [options.width='256']\n * @param    {Number}  [options.height='256']\n * @returns  {String}  url\n * @example\n * var baseUrl = 'http://geodata.state.nj.us/imagerywms/Natural2015';\n * var layer = 'Natural2015';\n * var url = whoots.getURL(baseUrl, layer, 154308, 197167, 19);\n */\nfunction getURL(baseUrl, layer, x, y, z, options) {\n    options = options || {};\n\n    var url = baseUrl + '?' + [\n        'bbox='    + getTileBBox(x, y, z),\n        'format='  + (options.format || 'image/png'),\n        'service=' + (options.service || 'WMS'),\n        'version=' + (options.version || '1.1.1'),\n        'request=' + (options.request || 'GetMap'),\n        'srs='     + (options.srs || 'EPSG:3857'),\n        'width='   + (options.width || 256),\n        'height='  + (options.height || 256),\n        'layers='  + layer\n    ].join('&');\n\n    return url;\n}\n\n\n/**\n * getTileBBox\n *\n * @param    {Number}  x  Tile coordinate x\n * @param    {Number}  y  Tile coordinate y\n * @param    {Number}  z  Tile zoom\n * @returns  {String}  String of the bounding box\n */\nfunction getTileBBox(x, y, z) {\n    // for Google/OSM tile scheme we need to alter the y\n    y = (Math.pow(2, z) - y - 1);\n\n    var min = getMercCoords(x * 256, y * 256, z),\n        max = getMercCoords((x + 1) * 256, (y + 1) * 256, z);\n\n    return min[0] + ',' + min[1] + ',' + max[0] + ',' + max[1];\n}\n\n\n/**\n * getMercCoords\n *\n * @param    {Number}  x  Pixel coordinate x\n * @param    {Number}  y  Pixel coordinate y\n * @param    {Number}  z  Tile zoom\n * @returns  {Array}   [x, y]\n */\nfunction getMercCoords(x, y, z) {\n    var resolution = (2 * Math.PI * 6378137 / 256) / Math.pow(2, z),\n        merc_x = (x * resolution - 2 * Math.PI  * 6378137 / 2.0),\n        merc_y = (y * resolution - 2 * Math.PI  * 6378137 / 2.0);\n\n    return [merc_x, merc_y];\n}\n\nexports.getURL = getURL;\nexports.getTileBBox = getTileBBox;\nexports.getMercCoords = getMercCoords;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","'use strict';\n//      \n\n/**\n * A coordinate is a column, row, zoom combination, often used\n * as the data component of a tile.\n *\n * @param {number} column\n * @param {number} row\n * @param {number} zoom\n * @private\n */\nclass Coordinate {\n                   \n                \n                 \n    constructor(column        , row        , zoom        ) {\n        this.column = column;\n        this.row = row;\n        this.zoom = zoom;\n    }\n\n    /**\n     * Create a clone of this coordinate that can be mutated without\n     * changing the original coordinate\n     *\n     * @returns {Coordinate} clone\n     * @private\n     * var coord = new Coordinate(0, 0, 0);\n     * var c2 = coord.clone();\n     * // since coord is cloned, modifying a property of c2 does\n     * // not modify it.\n     * c2.zoom = 2;\n     */\n    clone() {\n        return new Coordinate(this.column, this.row, this.zoom);\n    }\n\n    /**\n     * Zoom this coordinate to a given zoom level. This returns a new\n     * coordinate object, not mutating the old one.\n     *\n     * @param {number} zoom\n     * @returns {Coordinate} zoomed coordinate\n     * @private\n     * @example\n     * var coord = new Coordinate(0, 0, 0);\n     * var c2 = coord.zoomTo(1);\n     * c2 // equals new Coordinate(0, 0, 1);\n     */\n    zoomTo(zoom        ) { return this.clone()._zoomTo(zoom); }\n\n    /**\n     * Subtract the column and row values of this coordinate from those\n     * of another coordinate. The other coordinat will be zoomed to the\n     * same level as `this` before the subtraction occurs\n     *\n     * @param {Coordinate} c other coordinate\n     * @returns {Coordinate} result\n     * @private\n     */\n    sub(c            ) { return this.clone()._sub(c); }\n\n    _zoomTo(zoom        ) {\n        const scale = Math.pow(2, zoom - this.zoom);\n        this.column *= scale;\n        this.row *= scale;\n        this.zoom = zoom;\n        return this;\n    }\n\n    _sub(c            ) {\n        c = c.zoomTo(this.zoom);\n        this.column -= c.column;\n        this.row -= c.row;\n        return this;\n    }\n}\n\nmodule.exports = Coordinate;\n","'use strict';\n\nconst assert = require('assert');\nconst WhooTS = require('@mapbox/whoots-js');\nconst Coordinate = require('../geo/coordinate');\n\nclass TileCoord {\n    constructor(z, x, y, w) {\n        assert(!isNaN(z) && z >= 0 && z % 1 === 0);\n        assert(!isNaN(x) && x >= 0 && x % 1 === 0);\n        assert(!isNaN(y) && y >= 0 && y % 1 === 0);\n\n        if (isNaN(w)) w = 0;\n\n        this.z = +z;\n        this.x = +x;\n        this.y = +y;\n        this.w = +w;\n\n        // calculate id\n        w *= 2;\n        if (w < 0) w = w * -1 - 1;\n        const dim = 1 << this.z;\n        this.id = ((dim * dim * w + dim * this.y + this.x) * 32) + this.z;\n\n        // for caching pos matrix calculation when rendering\n        this.posMatrix = null;\n    }\n\n    toString() {\n        return `${this.z}/${this.x}/${this.y}`;\n    }\n\n    toCoordinate(sourceMaxZoom) {\n        const zoom = Math.min(this.z, sourceMaxZoom === undefined ? this.z : sourceMaxZoom);\n        const tileScale = Math.pow(2, zoom);\n        const row = this.y;\n        const column = this.x + tileScale * this.w;\n        return new Coordinate(column, row, zoom);\n    }\n\n    // given a list of urls, choose a url template and return a tile URL\n    url(urls, sourceMaxZoom, scheme) {\n        const bbox = WhooTS.getTileBBox(this.x, this.y, this.z);\n        const quadkey = getQuadkey(this.z, this.x, this.y);\n\n        return urls[(this.x + this.y) % urls.length]\n            .replace('{prefix}', (this.x % 16).toString(16) + (this.y % 16).toString(16))\n            .replace('{z}', Math.min(this.z, sourceMaxZoom || this.z))\n            .replace('{x}', this.x)\n            .replace('{y}', scheme === 'tms' ? (Math.pow(2, this.z) - this.y - 1) : this.y)\n            .replace('{quadkey}', quadkey)\n            .replace('{bbox-epsg-3857}', bbox);\n    }\n\n    // Return the coordinate of the parent tile\n    parent(sourceMaxZoom) {\n        if (this.z === 0) return null;\n\n        // the id represents an overscaled tile, return the same coordinates with a lower z\n        if (this.z > sourceMaxZoom) {\n            return new TileCoord(this.z - 1, this.x, this.y, this.w);\n        }\n\n        return new TileCoord(this.z - 1, Math.floor(this.x / 2), Math.floor(this.y / 2), this.w);\n    }\n\n    wrapped() {\n        return new TileCoord(this.z, this.x, this.y, 0);\n    }\n\n    // Return the coordinates of the tile's children\n    children(sourceMaxZoom) {\n\n        if (this.z >= sourceMaxZoom) {\n            // return a single tile coord representing a an overscaled tile\n            return [new TileCoord(this.z + 1, this.x, this.y, this.w)];\n        }\n\n        const z = this.z + 1;\n        const x = this.x * 2;\n        const y = this.y * 2;\n        return [\n            new TileCoord(z, x, y, this.w),\n            new TileCoord(z, x + 1, y, this.w),\n            new TileCoord(z, x, y + 1, this.w),\n            new TileCoord(z, x + 1, y + 1, this.w)\n        ];\n    }\n}\n\n// Taken from polymaps src/Layer.js\n// https://github.com/simplegeo/polymaps/blob/master/src/Layer.js#L333-L383\n\nfunction edge(a, b) {\n    if (a.row > b.row) { const t = a; a = b; b = t; }\n    return {\n        x0: a.column,\n        y0: a.row,\n        x1: b.column,\n        y1: b.row,\n        dx: b.column - a.column,\n        dy: b.row - a.row\n    };\n}\n\nfunction scanSpans(e0, e1, ymin, ymax, scanLine) {\n    const y0 = Math.max(ymin, Math.floor(e1.y0));\n    const y1 = Math.min(ymax, Math.ceil(e1.y1));\n\n    // sort edges by x-coordinate\n    if ((e0.x0 === e1.x0 && e0.y0 === e1.y0) ?\n            (e0.x0 + e1.dy / e0.dy * e0.dx < e1.x1) :\n            (e0.x1 - e1.dy / e0.dy * e0.dx < e1.x0)) {\n        const t = e0; e0 = e1; e1 = t;\n    }\n\n    // scan lines!\n    const m0 = e0.dx / e0.dy;\n    const m1 = e1.dx / e1.dy;\n    const d0 = e0.dx > 0; // use y + 1 to compute x0\n    const d1 = e1.dx < 0; // use y + 1 to compute x1\n    for (let y = y0; y < y1; y++) {\n        const x0 = m0 * Math.max(0, Math.min(e0.dy, y + d0 - e0.y0)) + e0.x0;\n        const x1 = m1 * Math.max(0, Math.min(e1.dy, y + d1 - e1.y0)) + e1.x0;\n        scanLine(Math.floor(x1), Math.ceil(x0), y);\n    }\n}\n\nfunction scanTriangle(a, b, c, ymin, ymax, scanLine) {\n    let ab = edge(a, b),\n        bc = edge(b, c),\n        ca = edge(c, a);\n\n    let t;\n\n    // sort edges by y-length\n    if (ab.dy > bc.dy) { t = ab; ab = bc; bc = t; }\n    if (ab.dy > ca.dy) { t = ab; ab = ca; ca = t; }\n    if (bc.dy > ca.dy) { t = bc; bc = ca; ca = t; }\n\n    // scan span! scan span!\n    if (ab.dy) scanSpans(ca, ab, ymin, ymax, scanLine);\n    if (bc.dy) scanSpans(ca, bc, ymin, ymax, scanLine);\n}\n\nTileCoord.cover = function(z, bounds, actualZ, renderWorldCopies) {\n    if (renderWorldCopies === undefined) {\n        renderWorldCopies = true;\n    }\n    const tiles = 1 << z;\n    const t = {};\n\n    function scanLine(x0, x1, y) {\n        let x, w, wx, coord;\n        if (y >= 0 && y <= tiles) {\n            for (x = x0; x < x1; x++) {\n                w = Math.floor(x / tiles);\n                wx = (x % tiles + tiles) % tiles;\n                if (w === 0 || renderWorldCopies === true) {\n                    coord = new TileCoord(actualZ, wx, y, w);\n                    t[coord.id] = coord;\n                }\n            }\n        }\n    }\n\n    // Divide the screen up in two triangles and scan each of them:\n    // +---/\n    // | / |\n    // /---+\n    scanTriangle(bounds[0], bounds[1], bounds[2], 0, tiles, scanLine);\n    scanTriangle(bounds[2], bounds[3], bounds[0], 0, tiles, scanLine);\n\n    return Object.keys(t).map((id) => {\n        return t[id];\n    });\n};\n\n// Parse a packed integer id into a TileCoord object\nTileCoord.fromID = function(id) {\n    const z = id % 32, dim = 1 << z;\n    const xy = ((id - z) / 32);\n    const x = xy % dim, y = ((xy - x) / dim) % dim;\n    let w = Math.floor(xy / (dim * dim));\n    if (w % 2 !== 0) w = w * -1 - 1;\n    w /= 2;\n    return new TileCoord(z, x, y, w);\n};\n\nfunction getQuadkey(z, x, y) {\n    let quadkey = '', mask;\n    for (let i = z; i > 0; i--) {\n        mask = 1 << (i - 1);\n        quadkey += ((x & mask ? 1 : 0) + (y & mask ? 2 : 0));\n    }\n    return quadkey;\n}\n\nmodule.exports = TileCoord;\n","'use strict';\n\nclass Feature {\n    constructor(vectorTileFeature, z, x, y) {\n        this.type = 'Feature';\n\n        this._vectorTileFeature = vectorTileFeature;\n        vectorTileFeature._z = z;\n        vectorTileFeature._x = x;\n        vectorTileFeature._y = y;\n\n        this.properties = vectorTileFeature.properties;\n\n        if (vectorTileFeature.id != null) {\n            this.id = vectorTileFeature.id;\n        }\n    }\n\n    get geometry() {\n        if (this._geometry === undefined) {\n            this._geometry = this._vectorTileFeature.toGeoJSON(\n                this._vectorTileFeature._x,\n                this._vectorTileFeature._y,\n                this._vectorTileFeature._z).geometry;\n        }\n        return this._geometry;\n    }\n\n    set geometry(g) {\n        this._geometry = g;\n    }\n\n    toJSON() {\n        const json = {\n            geometry: this.geometry\n        };\n        for (const i in this) {\n            if (i === '_geometry' || i === '_vectorTileFeature') continue;\n            json[i] = this[i];\n        }\n        return json;\n    }\n}\n\nmodule.exports = Feature;\n","'use strict';\n\n// lightweight Buffer shim for pbf browser build\n// based on code from github.com/feross/buffer (MIT-licensed)\n\nmodule.exports = Buffer;\n\nvar ieee754 = require('ieee754');\n\nvar BufferMethods;\n\nfunction Buffer(length) {\n    var arr;\n    if (length && length.length) {\n        arr = length;\n        length = arr.length;\n    }\n    var buf = new Uint8Array(length || 0);\n    if (arr) buf.set(arr);\n\n    buf.readUInt32LE = BufferMethods.readUInt32LE;\n    buf.writeUInt32LE = BufferMethods.writeUInt32LE;\n    buf.readInt32LE = BufferMethods.readInt32LE;\n    buf.writeInt32LE = BufferMethods.writeInt32LE;\n    buf.readFloatLE = BufferMethods.readFloatLE;\n    buf.writeFloatLE = BufferMethods.writeFloatLE;\n    buf.readDoubleLE = BufferMethods.readDoubleLE;\n    buf.writeDoubleLE = BufferMethods.writeDoubleLE;\n    buf.toString = BufferMethods.toString;\n    buf.write = BufferMethods.write;\n    buf.slice = BufferMethods.slice;\n    buf.copy = BufferMethods.copy;\n\n    buf._isBuffer = true;\n    return buf;\n}\n\nvar lastStr, lastStrEncoded;\n\nBufferMethods = {\n    readUInt32LE: function(pos) {\n        return ((this[pos]) |\n            (this[pos + 1] << 8) |\n            (this[pos + 2] << 16)) +\n            (this[pos + 3] * 0x1000000);\n    },\n\n    writeUInt32LE: function(val, pos) {\n        this[pos] = val;\n        this[pos + 1] = (val >>> 8);\n        this[pos + 2] = (val >>> 16);\n        this[pos + 3] = (val >>> 24);\n    },\n\n    readInt32LE: function(pos) {\n        return ((this[pos]) |\n            (this[pos + 1] << 8) |\n            (this[pos + 2] << 16)) +\n            (this[pos + 3] << 24);\n    },\n\n    readFloatLE:  function(pos) { return ieee754.read(this, pos, true, 23, 4); },\n    readDoubleLE: function(pos) { return ieee754.read(this, pos, true, 52, 8); },\n\n    writeFloatLE:  function(val, pos) { return ieee754.write(this, val, pos, true, 23, 4); },\n    writeDoubleLE: function(val, pos) { return ieee754.write(this, val, pos, true, 52, 8); },\n\n    toString: function(encoding, start, end) {\n        var str = '',\n            tmp = '';\n\n        start = start || 0;\n        end = Math.min(this.length, end || this.length);\n\n        for (var i = start; i < end; i++) {\n            var ch = this[i];\n            if (ch <= 0x7F) {\n                str += decodeURIComponent(tmp) + String.fromCharCode(ch);\n                tmp = '';\n            } else {\n                tmp += '%' + ch.toString(16);\n            }\n        }\n\n        str += decodeURIComponent(tmp);\n\n        return str;\n    },\n\n    write: function(str, pos) {\n        var bytes = str === lastStr ? lastStrEncoded : encodeString(str);\n        for (var i = 0; i < bytes.length; i++) {\n            this[pos + i] = bytes[i];\n        }\n    },\n\n    slice: function(start, end) {\n        return this.subarray(start, end);\n    },\n\n    copy: function(buf, pos) {\n        pos = pos || 0;\n        for (var i = 0; i < this.length; i++) {\n            buf[pos + i] = this[i];\n        }\n    }\n};\n\nBufferMethods.writeInt32LE = BufferMethods.writeUInt32LE;\n\nBuffer.byteLength = function(str) {\n    lastStr = str;\n    lastStrEncoded = encodeString(str);\n    return lastStrEncoded.length;\n};\n\nBuffer.isBuffer = function(buf) {\n    return !!(buf && buf._isBuffer);\n};\n\nfunction encodeString(str) {\n    var length = str.length,\n        bytes = [];\n\n    for (var i = 0, c, lead; i < length; i++) {\n        c = str.charCodeAt(i); // code point\n\n        if (c > 0xD7FF && c < 0xE000) {\n\n            if (lead) {\n                if (c < 0xDC00) {\n                    bytes.push(0xEF, 0xBF, 0xBD);\n                    lead = c;\n                    continue;\n\n                } else {\n                    c = lead - 0xD800 << 10 | c - 0xDC00 | 0x10000;\n                    lead = null;\n                }\n\n            } else {\n                if (c > 0xDBFF || (i + 1 === length)) bytes.push(0xEF, 0xBF, 0xBD);\n                else lead = c;\n\n                continue;\n            }\n\n        } else if (lead) {\n            bytes.push(0xEF, 0xBF, 0xBD);\n            lead = null;\n        }\n\n        if (c < 0x80) bytes.push(c);\n        else if (c < 0x800) bytes.push(c >> 0x6 | 0xC0, c & 0x3F | 0x80);\n        else if (c < 0x10000) bytes.push(c >> 0xC | 0xE0, c >> 0x6 & 0x3F | 0x80, c & 0x3F | 0x80);\n        else bytes.push(c >> 0x12 | 0xF0, c >> 0xC & 0x3F | 0x80, c >> 0x6 & 0x3F | 0x80, c & 0x3F | 0x80);\n    }\n    return bytes;\n}\n","'use strict';\n\nmodule.exports = Pbf;\n\nvar Buffer = global.Buffer || require('./buffer');\n\nfunction Pbf(buf) {\n    this.buf = !Buffer.isBuffer(buf) ? new Buffer(buf || 0) : buf;\n    this.pos = 0;\n    this.length = this.buf.length;\n}\n\nPbf.Varint  = 0; // varint: int32, int64, uint32, uint64, sint32, sint64, bool, enum\nPbf.Fixed64 = 1; // 64-bit: double, fixed64, sfixed64\nPbf.Bytes   = 2; // length-delimited: string, bytes, embedded messages, packed repeated fields\nPbf.Fixed32 = 5; // 32-bit: float, fixed32, sfixed32\n\nvar SHIFT_LEFT_32 = (1 << 16) * (1 << 16),\n    SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32,\n    POW_2_63 = Math.pow(2, 63);\n\nPbf.prototype = {\n\n    destroy: function() {\n        this.buf = null;\n    },\n\n    // === READING =================================================================\n\n    readFields: function(readField, result, end) {\n        end = end || this.length;\n\n        while (this.pos < end) {\n            var val = this.readVarint(),\n                tag = val >> 3,\n                startPos = this.pos;\n\n            readField(tag, result, this);\n\n            if (this.pos === startPos) this.skip(val);\n        }\n        return result;\n    },\n\n    readMessage: function(readField, result) {\n        return this.readFields(readField, result, this.readVarint() + this.pos);\n    },\n\n    readFixed32: function() {\n        var val = this.buf.readUInt32LE(this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    readSFixed32: function() {\n        var val = this.buf.readInt32LE(this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    // 64-bit int handling is based on github.com/dpw/node-buffer-more-ints (MIT-licensed)\n\n    readFixed64: function() {\n        var val = this.buf.readUInt32LE(this.pos) + this.buf.readUInt32LE(this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readSFixed64: function() {\n        var val = this.buf.readUInt32LE(this.pos) + this.buf.readInt32LE(this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readFloat: function() {\n        var val = this.buf.readFloatLE(this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    readDouble: function() {\n        var val = this.buf.readDoubleLE(this.pos);\n        this.pos += 8;\n        return val;\n    },\n\n    readVarint: function() {\n        var buf = this.buf,\n            val, b;\n\n        b = buf[this.pos++]; val  =  b & 0x7f;        if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 7;  if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 14; if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 21; if (b < 0x80) return val;\n\n        return readVarintRemainder(val, this);\n    },\n\n    readVarint64: function() {\n        var startPos = this.pos,\n            val = this.readVarint();\n\n        if (val < POW_2_63) return val;\n\n        var pos = this.pos - 2;\n        while (this.buf[pos] === 0xff) pos--;\n        if (pos < startPos) pos = startPos;\n\n        val = 0;\n        for (var i = 0; i < pos - startPos + 1; i++) {\n            var b = ~this.buf[startPos + i] & 0x7f;\n            val += i < 4 ? b << i * 7 : b * Math.pow(2, i * 7);\n        }\n\n        return -val - 1;\n    },\n\n    readSVarint: function() {\n        var num = this.readVarint();\n        return num % 2 === 1 ? (num + 1) / -2 : num / 2; // zigzag encoding\n    },\n\n    readBoolean: function() {\n        return Boolean(this.readVarint());\n    },\n\n    readString: function() {\n        var end = this.readVarint() + this.pos,\n            str = this.buf.toString('utf8', this.pos, end);\n        this.pos = end;\n        return str;\n    },\n\n    readBytes: function() {\n        var end = this.readVarint() + this.pos,\n            buffer = this.buf.slice(this.pos, end);\n        this.pos = end;\n        return buffer;\n    },\n\n    // verbose for performance reasons; doesn't affect gzipped size\n\n    readPackedVarint: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readVarint());\n        return arr;\n    },\n    readPackedSVarint: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readSVarint());\n        return arr;\n    },\n    readPackedBoolean: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readBoolean());\n        return arr;\n    },\n    readPackedFloat: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readFloat());\n        return arr;\n    },\n    readPackedDouble: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readDouble());\n        return arr;\n    },\n    readPackedFixed32: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readFixed32());\n        return arr;\n    },\n    readPackedSFixed32: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readSFixed32());\n        return arr;\n    },\n    readPackedFixed64: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readFixed64());\n        return arr;\n    },\n    readPackedSFixed64: function() {\n        var end = this.readVarint() + this.pos, arr = [];\n        while (this.pos < end) arr.push(this.readSFixed64());\n        return arr;\n    },\n\n    skip: function(val) {\n        var type = val & 0x7;\n        if (type === Pbf.Varint) while (this.buf[this.pos++] > 0x7f) {}\n        else if (type === Pbf.Bytes) this.pos = this.readVarint() + this.pos;\n        else if (type === Pbf.Fixed32) this.pos += 4;\n        else if (type === Pbf.Fixed64) this.pos += 8;\n        else throw new Error('Unimplemented type: ' + type);\n    },\n\n    // === WRITING =================================================================\n\n    writeTag: function(tag, type) {\n        this.writeVarint((tag << 3) | type);\n    },\n\n    realloc: function(min) {\n        var length = this.length || 16;\n\n        while (length < this.pos + min) length *= 2;\n\n        if (length !== this.length) {\n            var buf = new Buffer(length);\n            this.buf.copy(buf);\n            this.buf = buf;\n            this.length = length;\n        }\n    },\n\n    finish: function() {\n        this.length = this.pos;\n        this.pos = 0;\n        return this.buf.slice(0, this.length);\n    },\n\n    writeFixed32: function(val) {\n        this.realloc(4);\n        this.buf.writeUInt32LE(val, this.pos);\n        this.pos += 4;\n    },\n\n    writeSFixed32: function(val) {\n        this.realloc(4);\n        this.buf.writeInt32LE(val, this.pos);\n        this.pos += 4;\n    },\n\n    writeFixed64: function(val) {\n        this.realloc(8);\n        this.buf.writeInt32LE(val & -1, this.pos);\n        this.buf.writeUInt32LE(Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeSFixed64: function(val) {\n        this.realloc(8);\n        this.buf.writeInt32LE(val & -1, this.pos);\n        this.buf.writeInt32LE(Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeVarint: function(val) {\n        val = +val;\n\n        if (val > 0xfffffff) {\n            writeBigVarint(val, this);\n            return;\n        }\n\n        this.realloc(4);\n\n        this.buf[this.pos++] =           val & 0x7f  | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] =   (val >>> 7) & 0x7f;\n    },\n\n    writeSVarint: function(val) {\n        this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n    },\n\n    writeBoolean: function(val) {\n        this.writeVarint(Boolean(val));\n    },\n\n    writeString: function(str) {\n        str = String(str);\n        var bytes = Buffer.byteLength(str);\n        this.writeVarint(bytes);\n        this.realloc(bytes);\n        this.buf.write(str, this.pos);\n        this.pos += bytes;\n    },\n\n    writeFloat: function(val) {\n        this.realloc(4);\n        this.buf.writeFloatLE(val, this.pos);\n        this.pos += 4;\n    },\n\n    writeDouble: function(val) {\n        this.realloc(8);\n        this.buf.writeDoubleLE(val, this.pos);\n        this.pos += 8;\n    },\n\n    writeBytes: function(buffer) {\n        var len = buffer.length;\n        this.writeVarint(len);\n        this.realloc(len);\n        for (var i = 0; i < len; i++) this.buf[this.pos++] = buffer[i];\n    },\n\n    writeRawMessage: function(fn, obj) {\n        this.pos++; // reserve 1 byte for short message length\n\n        // write the message directly to the buffer and see how much was written\n        var startPos = this.pos;\n        fn(obj, this);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) reallocForRawMessage(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeMessage: function(tag, fn, obj) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeRawMessage(fn, obj);\n    },\n\n    writePackedVarint:   function(tag, arr) { this.writeMessage(tag, writePackedVarint, arr);   },\n    writePackedSVarint:  function(tag, arr) { this.writeMessage(tag, writePackedSVarint, arr);  },\n    writePackedBoolean:  function(tag, arr) { this.writeMessage(tag, writePackedBoolean, arr);  },\n    writePackedFloat:    function(tag, arr) { this.writeMessage(tag, writePackedFloat, arr);    },\n    writePackedDouble:   function(tag, arr) { this.writeMessage(tag, writePackedDouble, arr);   },\n    writePackedFixed32:  function(tag, arr) { this.writeMessage(tag, writePackedFixed32, arr);  },\n    writePackedSFixed32: function(tag, arr) { this.writeMessage(tag, writePackedSFixed32, arr); },\n    writePackedFixed64:  function(tag, arr) { this.writeMessage(tag, writePackedFixed64, arr);  },\n    writePackedSFixed64: function(tag, arr) { this.writeMessage(tag, writePackedSFixed64, arr); },\n\n    writeBytesField: function(tag, buffer) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeBytes(buffer);\n    },\n    writeFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFixed32(val);\n    },\n    writeSFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeSFixed32(val);\n    },\n    writeFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeFixed64(val);\n    },\n    writeSFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeSFixed64(val);\n    },\n    writeVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeVarint(val);\n    },\n    writeSVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeSVarint(val);\n    },\n    writeStringField: function(tag, str) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeString(str);\n    },\n    writeFloatField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFloat(val);\n    },\n    writeDoubleField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeDouble(val);\n    },\n    writeBooleanField: function(tag, val) {\n        this.writeVarintField(tag, Boolean(val));\n    }\n};\n\nfunction readVarintRemainder(val, pbf) {\n    var buf = pbf.buf, b;\n\n    b = buf[pbf.pos++]; val += (b & 0x7f) * 0x10000000;         if (b < 0x80) return val;\n    b = buf[pbf.pos++]; val += (b & 0x7f) * 0x800000000;        if (b < 0x80) return val;\n    b = buf[pbf.pos++]; val += (b & 0x7f) * 0x40000000000;      if (b < 0x80) return val;\n    b = buf[pbf.pos++]; val += (b & 0x7f) * 0x2000000000000;    if (b < 0x80) return val;\n    b = buf[pbf.pos++]; val += (b & 0x7f) * 0x100000000000000;  if (b < 0x80) return val;\n    b = buf[pbf.pos++]; val += (b & 0x7f) * 0x8000000000000000; if (b < 0x80) return val;\n\n    throw new Error('Expected varint not more than 10 bytes');\n}\n\nfunction writeBigVarint(val, pbf) {\n    pbf.realloc(10);\n\n    var maxPos = pbf.pos + 10;\n\n    while (val >= 1) {\n        if (pbf.pos >= maxPos) throw new Error('Given varint doesn\\'t fit into 10 bytes');\n        var b = val & 0xff;\n        pbf.buf[pbf.pos++] = b | (val >= 0x80 ? 0x80 : 0);\n        val /= 0x80;\n    }\n}\n\nfunction reallocForRawMessage(startPos, len, pbf) {\n    var extraLen =\n        len <= 0x3fff ? 1 :\n        len <= 0x1fffff ? 2 :\n        len <= 0xfffffff ? 3 : Math.ceil(Math.log(len) / (Math.LN2 * 7));\n\n    // if 1 byte isn't enough for encoding message length, shift the data to the right\n    pbf.realloc(extraLen);\n    for (var i = pbf.pos - 1; i >= startPos; i--) pbf.buf[i + extraLen] = pbf.buf[i];\n}\n\nfunction writePackedVarint(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeVarint(arr[i]);   }\nfunction writePackedSVarint(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeSVarint(arr[i]);  }\nfunction writePackedFloat(arr, pbf)    { for (var i = 0; i < arr.length; i++) pbf.writeFloat(arr[i]);    }\nfunction writePackedDouble(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeDouble(arr[i]);   }\nfunction writePackedBoolean(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeBoolean(arr[i]);  }\nfunction writePackedFixed32(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed32(arr[i]);  }\nfunction writePackedSFixed32(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed32(arr[i]); }\nfunction writePackedFixed64(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed64(arr[i]);  }\nfunction writePackedSFixed64(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed64(arr[i]); }\n","'use strict';\n\nmodule.exports = Point;\n\nfunction Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n    clone: function() { return new Point(this.x, this.y); },\n\n    add:     function(p) { return this.clone()._add(p);     },\n    sub:     function(p) { return this.clone()._sub(p);     },\n    mult:    function(k) { return this.clone()._mult(k);    },\n    div:     function(k) { return this.clone()._div(k);     },\n    rotate:  function(a) { return this.clone()._rotate(a);  },\n    matMult: function(m) { return this.clone()._matMult(m); },\n    unit:    function() { return this.clone()._unit(); },\n    perp:    function() { return this.clone()._perp(); },\n    round:   function() { return this.clone()._round(); },\n\n    mag: function() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    equals: function(p) {\n        return this.x === p.x &&\n               this.y === p.y;\n    },\n\n    dist: function(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    distSqr: function(p) {\n        var dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    angle: function() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    angleTo: function(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    angleWith: function(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    // Find the angle of the two vectors, solving the formula for the cross product a x b = |a||b|sin() for .\n    angleWithSep: function(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    _matMult: function(m) {\n        var x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _add: function(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    _sub: function(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    _mult: function(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    _div: function(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    _unit: function() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp: function() {\n        var y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    _rotate: function(angle) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round: function() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n};\n\n// constructs Point from an array if necessary\nPoint.convert = function (a) {\n    if (a instanceof Point) {\n        return a;\n    }\n    if (Array.isArray(a)) {\n        return new Point(a[0], a[1]);\n    }\n    return a;\n};\n","module.exports.VectorTile = require('./lib/vectortile.js');\nmodule.exports.VectorTileFeature = require('./lib/vectortilefeature.js');\nmodule.exports.VectorTileLayer = require('./lib/vectortilelayer.js');\n","'use strict';\n\nvar VectorTileLayer = require('./vectortilelayer');\n\nmodule.exports = VectorTile;\n\nfunction VectorTile(pbf, end) {\n    this.layers = pbf.readFields(readTile, {}, end);\n}\n\nfunction readTile(tag, layers, pbf) {\n    if (tag === 3) {\n        var layer = new VectorTileLayer(pbf, pbf.readVarint() + pbf.pos);\n        if (layer.length) layers[layer.name] = layer;\n    }\n}\n\n","'use strict';\n\nvar Point = require('point-geometry');\n\nmodule.exports = VectorTileFeature;\n\nfunction VectorTileFeature(pbf, end, extent, keys, values) {\n    // Public\n    this.properties = {};\n    this.extent = extent;\n    this.type = 0;\n\n    // Private\n    this._pbf = pbf;\n    this._geometry = -1;\n    this._keys = keys;\n    this._values = values;\n\n    pbf.readFields(readFeature, this, end);\n}\n\nfunction readFeature(tag, feature, pbf) {\n    if (tag == 1) feature.id = pbf.readVarint();\n    else if (tag == 2) readTag(pbf, feature);\n    else if (tag == 3) feature.type = pbf.readVarint();\n    else if (tag == 4) feature._geometry = pbf.pos;\n}\n\nfunction readTag(pbf, feature) {\n    var end = pbf.readVarint() + pbf.pos;\n\n    while (pbf.pos < end) {\n        var key = feature._keys[pbf.readVarint()],\n            value = feature._values[pbf.readVarint()];\n        feature.properties[key] = value;\n    }\n}\n\nVectorTileFeature.types = ['Unknown', 'Point', 'LineString', 'Polygon'];\n\nVectorTileFeature.prototype.loadGeometry = function() {\n    var pbf = this._pbf;\n    pbf.pos = this._geometry;\n\n    var end = pbf.readVarint() + pbf.pos,\n        cmd = 1,\n        length = 0,\n        x = 0,\n        y = 0,\n        lines = [],\n        line;\n\n    while (pbf.pos < end) {\n        if (!length) {\n            var cmdLen = pbf.readVarint();\n            cmd = cmdLen & 0x7;\n            length = cmdLen >> 3;\n        }\n\n        length--;\n\n        if (cmd === 1 || cmd === 2) {\n            x += pbf.readSVarint();\n            y += pbf.readSVarint();\n\n            if (cmd === 1) { // moveTo\n                if (line) lines.push(line);\n                line = [];\n            }\n\n            line.push(new Point(x, y));\n\n        } else if (cmd === 7) {\n\n            // Workaround for https://github.com/mapbox/mapnik-vector-tile/issues/90\n            if (line) {\n                line.push(line[0].clone()); // closePolygon\n            }\n\n        } else {\n            throw new Error('unknown command ' + cmd);\n        }\n    }\n\n    if (line) lines.push(line);\n\n    return lines;\n};\n\nVectorTileFeature.prototype.bbox = function() {\n    var pbf = this._pbf;\n    pbf.pos = this._geometry;\n\n    var end = pbf.readVarint() + pbf.pos,\n        cmd = 1,\n        length = 0,\n        x = 0,\n        y = 0,\n        x1 = Infinity,\n        x2 = -Infinity,\n        y1 = Infinity,\n        y2 = -Infinity;\n\n    while (pbf.pos < end) {\n        if (!length) {\n            var cmdLen = pbf.readVarint();\n            cmd = cmdLen & 0x7;\n            length = cmdLen >> 3;\n        }\n\n        length--;\n\n        if (cmd === 1 || cmd === 2) {\n            x += pbf.readSVarint();\n            y += pbf.readSVarint();\n            if (x < x1) x1 = x;\n            if (x > x2) x2 = x;\n            if (y < y1) y1 = y;\n            if (y > y2) y2 = y;\n\n        } else if (cmd !== 7) {\n            throw new Error('unknown command ' + cmd);\n        }\n    }\n\n    return [x1, y1, x2, y2];\n};\n\nVectorTileFeature.prototype.toGeoJSON = function(x, y, z) {\n    var size = this.extent * Math.pow(2, z),\n        x0 = this.extent * x,\n        y0 = this.extent * y,\n        coords = this.loadGeometry(),\n        type = VectorTileFeature.types[this.type],\n        i, j;\n\n    function project(line) {\n        for (var j = 0; j < line.length; j++) {\n            var p = line[j], y2 = 180 - (p.y + y0) * 360 / size;\n            line[j] = [\n                (p.x + x0) * 360 / size - 180,\n                360 / Math.PI * Math.atan(Math.exp(y2 * Math.PI / 180)) - 90\n            ];\n        }\n    }\n\n    switch (this.type) {\n    case 1:\n        var points = [];\n        for (i = 0; i < coords.length; i++) {\n            points[i] = coords[i][0];\n        }\n        coords = points;\n        project(coords);\n        break;\n\n    case 2:\n        for (i = 0; i < coords.length; i++) {\n            project(coords[i]);\n        }\n        break;\n\n    case 3:\n        coords = classifyRings(coords);\n        for (i = 0; i < coords.length; i++) {\n            for (j = 0; j < coords[i].length; j++) {\n                project(coords[i][j]);\n            }\n        }\n        break;\n    }\n\n    if (coords.length === 1) {\n        coords = coords[0];\n    } else {\n        type = 'Multi' + type;\n    }\n\n    var result = {\n        type: \"Feature\",\n        geometry: {\n            type: type,\n            coordinates: coords\n        },\n        properties: this.properties\n    };\n\n    if ('id' in this) {\n        result.id = this.id;\n    }\n\n    return result;\n};\n\n// classifies an array of rings into polygons with outer rings and holes\n\nfunction classifyRings(rings) {\n    var len = rings.length;\n\n    if (len <= 1) return [rings];\n\n    var polygons = [],\n        polygon,\n        ccw;\n\n    for (var i = 0; i < len; i++) {\n        var area = signedArea(rings[i]);\n        if (area === 0) continue;\n\n        if (ccw === undefined) ccw = area < 0;\n\n        if (ccw === area < 0) {\n            if (polygon) polygons.push(polygon);\n            polygon = [rings[i]];\n\n        } else {\n            polygon.push(rings[i]);\n        }\n    }\n    if (polygon) polygons.push(polygon);\n\n    return polygons;\n}\n\nfunction signedArea(ring) {\n    var sum = 0;\n    for (var i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n        p1 = ring[i];\n        p2 = ring[j];\n        sum += (p2.x - p1.x) * (p1.y + p2.y);\n    }\n    return sum;\n}\n","'use strict';\n\nvar VectorTileFeature = require('./vectortilefeature.js');\n\nmodule.exports = VectorTileLayer;\n\nfunction VectorTileLayer(pbf, end) {\n    // Public\n    this.version = 1;\n    this.name = null;\n    this.extent = 4096;\n    this.length = 0;\n\n    // Private\n    this._pbf = pbf;\n    this._keys = [];\n    this._values = [];\n    this._features = [];\n\n    pbf.readFields(readLayer, this, end);\n\n    this.length = this._features.length;\n}\n\nfunction readLayer(tag, layer, pbf) {\n    if (tag === 15) layer.version = pbf.readVarint();\n    else if (tag === 1) layer.name = pbf.readString();\n    else if (tag === 5) layer.extent = pbf.readVarint();\n    else if (tag === 2) layer._features.push(pbf.pos);\n    else if (tag === 3) layer._keys.push(pbf.readString());\n    else if (tag === 4) layer._values.push(readValueMessage(pbf));\n}\n\nfunction readValueMessage(pbf) {\n    var value = null,\n        end = pbf.readVarint() + pbf.pos;\n\n    while (pbf.pos < end) {\n        var tag = pbf.readVarint() >> 3;\n\n        value = tag === 1 ? pbf.readString() :\n            tag === 2 ? pbf.readFloat() :\n            tag === 3 ? pbf.readDouble() :\n            tag === 4 ? pbf.readVarint64() :\n            tag === 5 ? pbf.readVarint() :\n            tag === 6 ? pbf.readSVarint() :\n            tag === 7 ? pbf.readBoolean() : null;\n    }\n\n    return value;\n}\n\n// return feature `i` from this layer as a `VectorTileFeature`\nVectorTileLayer.prototype.feature = function(i) {\n    if (i < 0 || i >= this._features.length) throw new Error('feature index out of bounds');\n\n    this._pbf.pos = this._features[i];\n\n    var end = this._pbf.readVarint() + this._pbf.pos;\n    return new VectorTileFeature(this._pbf, end, this.extent, this._keys, this._values);\n};\n","//adapted from https://github.com/mapbox/mapbox-gl-js/blob/5886421ea9a5ae26797c950ec698be473fe87d17/src/style-spec/feature_filter/index.js\n\n'use strict';\n\nmodule.exports = createFilter;\n\nconst types = ['Unknown', 'Point', 'LineString', 'Polygon'];\n\n/**\n * Given a filter expressed as nested arrays, return a new function\n * that evaluates whether a given feature (with a .properties or .tags property)\n * passes its test.\n *\n * @private\n * @param {Array} filter mapbox gl filter\n * @returns {Function} filter-evaluating function\n */\nfunction createFilter(filter) {\n    return new Function('f', `var p = (f && f.properties || {}); return ${compile(filter)}`);\n}\n\nfunction compile(filter) {\n    if (!filter) return 'true';\n    const op = filter[0];\n    if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\n    const str =\n        op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) :\n        op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) :\n        op === '<' ||\n        op === '>' ||\n        op === '<=' ||\n        op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) :\n        op === '~=' ? compileRegexOp(filter[1], filter[2]) :\n        op === 'any' ? compileLogicalOp(filter.slice(1), '||') :\n        op === 'all' ? compileLogicalOp(filter.slice(1), '&&') :\n        op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) :\n        op === 'in' ? compileInOp(filter[1], filter.slice(2)) :\n        op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) :\n        op === 'has' ? compileHasOp(filter[1]) :\n        op === '!has' ? compileNegation(compileHasOp(filter[1])) :\n        'true';\n    return `(${str})`;\n}\n\nfunction compilePropertyReference(property) {\n    return property === '$type' ? 'f.type' :\n        property === '$id' ? 'f.id' :\n        `p[${JSON.stringify(property)}]`;\n}\n\nfunction compileComparisonOp(property, value, op, checkType) {\n    const left = compilePropertyReference(property);\n    const right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\n    return (checkType ? `typeof ${left}=== typeof ${right}&&` : '') + left + op + right;\n}\n\nfunction compileRegexOp(property, value) {\n    const left = compilePropertyReference(property);\n    const right = value;\n    return `${'function(left, right) {' +\n    'if(!left) return false; return left.toString().match(right);' +\n    '}('}${left}, ${right})`;\n}\n\nfunction compileLogicalOp(expressions, op) {\n    return expressions.map(compile).join(op);\n}\n\nfunction compileInOp(property, values) {\n    if (property === '$type') values = values.map((value) => {\n        return types.indexOf(value);\n    });\n    const left = JSON.stringify(values.sort(compare));\n    const right = compilePropertyReference(property);\n\n    if (values.length <= 200) return `${left}.indexOf(${right}) !== -1`;\n\n    return `${'function(v, a, i, j) {' +\n        'while (i <= j) { var m = (i + j) >> 1;' +\n        '    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;' +\n        '}' +\n    'return false; }('}${right}, ${left},0,${values.length - 1})`;\n}\n\nfunction compileHasOp(property) {\n    return property === '$id' ? '\"id\" in f' : `${JSON.stringify(property)} in p`;\n}\n\nfunction compileNegation(expression) {\n    return `!(${expression})`;\n}\n\n// Comparison function to sort numbers and strings\nfunction compare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n","'use strict';\n\nconst vt = require('vector-tile');\nconst Protobuf = require('pbf');\nconst GeoJSONFeature = require('mapbox-gl/src/util/vectortile_to_geojson');\nconst TileCoord = require('mapbox-gl/src/source/tile_coord');\nconst featureFilter = require('./feature_filter');\n\nmodule.exports = {\n\n    querySourceFeatures(sourceID, params, map) {\n        const sourceCache = map.style.sourceCaches[sourceID];\n\n         //from: https://github.com/mapbox/mapbox-gl-js/blob/5886421ea9a5ae26797c950ec698be473fe87d17/src/source/query_features.js#L25\n        const tiles = sourceCache.getRenderableIds().map((id) => {\n            return sourceCache.getTileByID(id);\n        });\n\n        const result = [];\n\n        const dataTiles = {};\n        for (let i = 0; i < tiles.length; i++) {\n            const tile = tiles[i];\n            const dataID = new TileCoord(Math.min(tile.sourceMaxZoom, tile.coord.z), tile.coord.x, tile.coord.y, 0).id;\n            if (!dataTiles[dataID]) {\n                dataTiles[dataID] = true;\n                this.queryTile(result, params, tile);\n            }\n        }\n\n        return result;\n\n    },\n\n    queryTile(result, params, tile) {\n        //from: https://github.com/mapbox/mapbox-gl-js/blob/5886421ea9a5ae26797c950ec698be473fe87d17/src/source/tile.js#L175\n        if (!tile.rawTileData) return;\n\n        if (!tile.vtLayers) {\n            tile.vtLayers = new vt.VectorTile(new Protobuf(tile.rawTileData)).layers;\n        }\n\n        const layer = tile.vtLayers._geojsonTileLayer || tile.vtLayers[params.sourceLayer];\n\n        if (!layer) return;\n\n        const filter = featureFilter(params && params.filter);\n        const coord = {z: tile.coord.z, x: tile.coord.x, y: tile.coord.y};\n\n        for (let i = 0; i < layer.length; i++) {\n            const feature = layer.feature(i);\n            if (filter(feature)) {\n                const geojsonFeature = new GeoJSONFeature(feature, tile.coord.z, tile.coord.x, tile.coord.y);\n                geojsonFeature.tile = coord;\n                result.push(geojsonFeature);\n            }\n        }\n    }\n\n};\n"]}